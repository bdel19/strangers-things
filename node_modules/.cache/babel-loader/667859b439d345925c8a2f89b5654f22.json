{"ast":null,"code":"import _regeneratorRuntime from\"/home/bdel19/course_work/strangers-things/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/bdel19/course_work/strangers-things/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/bdel19/course_work/strangers-things/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{Home,Posts,Account}from\"./components\";import{Route,Switch,Link,useHistory}from\"react-router-dom\";import{fetchPosts,fetchUser}from\"./api/api\";import\"./App.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(window.localStorage.getItem(\"token\")||\"\"),_useState4=_slicedToArray(_useState3,2),token=_useState4[0],setToken=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var history=useHistory();useEffect(function(){var getPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetchPosts();case 3:result=_context.sent;setPosts(result);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(\"getPostError\",_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function getPosts(){return _ref.apply(this,arguments);};}();getPosts();},[]);useEffect(function(){console.log(\"HEY!\");if(token){var getUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _yield$fetchUser,user;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetchUser(token);case 2:_yield$fetchUser=_context2.sent;user=_yield$fetchUser.user;setUser(posts.username);console.log(\"USER\",user);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function getUser(){return _ref2.apply(this,arguments);};}();getUser();}},[token]);useEffect(function(){window.localStorage.setItem(\"token\",token);},[token]);var logOut=function logOut(){setToken(\"\");setUser(null);history.push(\"/\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"nav\",{className:\"ui secondary menu\",children:[/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/\",children:\"Home\"}),/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/posts\",children:\"Posts\"}),/*#__PURE__*/_jsx(\"span\",{className:\"right menu\",children:token?/*#__PURE__*/_jsx(\"button\",{className:\"item\",onClick:logOut,children:\"Logout\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/account/login\",children:\"Log In\"}),/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/account/signup\",children:\"Sign Up\"})]})})]}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{className:\"item\",exact:true,path:\"/\",children:/*#__PURE__*/_jsx(Home,{user:user})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/posts\",children:/*#__PURE__*/_jsx(Posts,{posts:posts})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/account/:action\",children:/*#__PURE__*/_jsx(Account,{setToken:setToken})})]})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","Home","Posts","Account","Route","Switch","Link","useHistory","fetchPosts","fetchUser","App","posts","setPosts","window","localStorage","getItem","token","setToken","user","setUser","history","getPosts","result","console","error","log","getUser","username","setItem","logOut","push"],"sources":["/home/bdel19/course_work/strangers-things/src/App.js"],"sourcesContent":["import React, {useState, useEffect } from \"react\";\nimport { Home, Posts, Account } from \"./components\";\nimport { Route, Switch, Link, useHistory } from \"react-router-dom\";\nimport { fetchPosts, fetchUser } from \"./api/api\";\nimport \"./App.css\";\n\nconst App = () => {\n    const [posts, setPosts] = useState([]);\n    const [token, setToken] = useState(window.localStorage.getItem(\"token\") || \"\");\n    const [user, setUser] = useState(null);\n    const history = useHistory();\n    \n\n    useEffect(() => {\n        const getPosts = async() => {\n            try{\n                const result = await fetchPosts();\n                setPosts(result);\n            }catch(error){\n                console.error(\"getPostError\",error);\n            }\n        };\n        getPosts(); \n    }, []);\n\n    useEffect(() => {\n        console.log(\"HEY!\");\n        if (token) {\n            const getUser = async () => {\n                const { user } = await fetchUser(token);\n                setUser(posts.username);\n                console.log(\"USER\",user);\n            }\n            getUser();\n        }\n    }, [token]);\n\n    useEffect(() => {\n        window.localStorage.setItem(\"token\", token)\n    },[token]);\n\n    const logOut = () => {\n        setToken(\"\");\n        setUser(null);\n        history.push(\"/\");\n    }\n\n    return (\n        <div className=\"container\">\n            <nav className=\"ui secondary menu\">\n                <Link className=\"item\" to=\"/\">Home</Link>\n                <Link className=\"item\" to=\"/posts\">Posts</Link>\n                <span className=\"right menu\">\n                    {token ? (\n                        <button className=\"item\" onClick={logOut}>\n                            Logout\n                        </button>\n                    ):(\n                    <>\n                    <Link className=\"item\" to =\"/account/login\">Log In</Link>\n                    <Link className=\"item\" to =\"/account/signup\">Sign Up</Link>\n                    </>\n                    )}\n                    \n                </span>\n            </nav>\n            <Switch>\n                <Route className=\"item\" exact path=\"/\">\n                    <Home user = {user}/>\n                </Route>\n                <Route className=\"item\" path=\"/posts\">\n                    <Posts posts={posts}/>\n                </Route>\n                <Route className=\"item\" path=\"/account/:action\">\n                    <Account setToken={setToken}/>\n                </Route>\n            </Switch>\n        </div>\n    );\n    \n};\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}