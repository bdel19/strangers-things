{"ast":null,"code":"import _regeneratorRuntime from\"/home/bdel19/course_work/strangers-things/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/bdel19/course_work/strangers-things/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/bdel19/course_work/strangers-things/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{Home,Posts,Account,PostCreateForm}from\"./components\";import{Route,Switch,Link,useHistory}from\"react-router-dom\";import{fetchPosts,fetchUser}from\"./api/api\";import\"./App.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){console.log(\"running App\");var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(window.localStorage.getItem(\"token\")||null),_useState4=_slicedToArray(_useState3,2),token=_useState4[0],setToken=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var history=useHistory();useEffect(function(){var getPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$fetchPosts,error,posts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"running getPosts\");_context.next=3;return fetchPosts(token);case 3:_yield$fetchPosts=_context.sent;error=_yield$fetchPosts.error;posts=_yield$fetchPosts.posts;if(error){console.error(error);}setPosts(posts);case 8:case\"end\":return _context.stop();}}},_callee);}));return function getPosts(){return _ref.apply(this,arguments);};}();getPosts();},[]);useEffect(function(){if(token){var getUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _yield$fetchUser,user;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(\"running getUser\");_context2.next=3;return fetchUser(token);case 3:_yield$fetchUser=_context2.sent;user=_yield$fetchUser.user;setUser(user);console.log(\"USER\",user);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function getUser(){return _ref2.apply(this,arguments);};}();getUser();};},[token]);useEffect(function(){if(token){window.localStorage.setItem(\"token\",token);}else{window.localStorage.removeItem(\"token\");}},[token]);var logOut=function logOut(){setToken(null);setUser(null);history.push(\"/\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"nav\",{className:\"ui secondary menu\",children:[/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/\",children:\"Home\"}),/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/posts\",children:\"Posts\"}),/*#__PURE__*/_jsx(\"span\",{className:\"right menu\",children:token?/*#__PURE__*/_jsx(\"button\",{className:\"item\",onClick:logOut,children:\"Logout\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/account/login\",children:\"Log In\"}),/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/account/register\",children:\"Sign Up\"})]})})]}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",children:/*#__PURE__*/_jsx(Home,{user:user})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/posts/create\",children:/*#__PURE__*/_jsx(PostCreateForm,{token:token,setPosts:setPosts})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/posts\",children:/*#__PURE__*/_jsx(Posts,{posts:posts,token:token,setPosts:setPosts})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/account/:action\",children:/*#__PURE__*/_jsx(Account,{setToken:setToken})})]})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","Home","Posts","Account","PostCreateForm","Route","Switch","Link","useHistory","fetchPosts","fetchUser","App","console","log","posts","setPosts","window","localStorage","getItem","token","setToken","user","setUser","history","getPosts","error","getUser","setItem","removeItem","logOut","push"],"sources":["/home/bdel19/course_work/strangers-things/src/App.js"],"sourcesContent":["import React, {useState, useEffect } from \"react\";\nimport { Home, Posts, Account, PostCreateForm } from \"./components\";\nimport { Route, Switch, Link, useHistory } from \"react-router-dom\";\nimport { fetchPosts, fetchUser } from \"./api/api\";\nimport \"./App.css\";\n\nconst App = () => {\n    console.log(\"running App\")\n    const [posts, setPosts] = useState([]);\n    const [token, setToken] = useState(\n        window.localStorage.getItem(\"token\") || null\n    );\n    const [user, setUser] = useState(null);\n\n    const history = useHistory();\n    \n\n    useEffect(() => {\n        const getPosts = async() => {\n            console.log(\"running getPosts\")\n            const {error, posts} = await fetchPosts(token);\n\n            if (error) {\n                console.error(error)\n            }\n\n            setPosts(posts);\n        };\n        getPosts(); \n    }, []);\n\n    useEffect(() => {\n        if (token) {\n            const getUser = async () => {\n                console.log(\"running getUser\")\n                const { user } = await fetchUser(token);\n                setUser(user);\n                console.log(\"USER\", user);\n            };\n            getUser();\n        };\n    }, [token]);\n\n    useEffect(() => {\n        if (token){\n        window.localStorage.setItem(\"token\", token);\n        } else {\n            window.localStorage.removeItem(\"token\");\n        }\n    },[token]);\n\n    const logOut = () => {\n        setToken(null);\n        setUser(null);\n        history.push(\"/\");\n    };\n\n    return (\n        <div className=\"container\">\n            <nav className=\"ui secondary menu\">\n                <Link className=\"item\" to=\"/\">Home</Link>\n                <Link className=\"item\" to=\"/posts\">Posts</Link>\n                <span className=\"right menu\">\n                    {token ? (\n                        <button className=\"item\" onClick={logOut}>\n                            Logout\n                        </button>\n                    ):(\n                    <>\n                    <Link className=\"item\" to =\"/account/login\">Log In</Link>\n                    <Link className=\"item\" to =\"/account/register\">Sign Up</Link>\n                    </>\n                    )}\n                    \n                </span>\n            </nav>\n            <Switch>\n                \n                <Route exact path=\"/\">\n                    <Home user = {user}/>\n                </Route>\n                \n                <Route className=\"item\" path=\"/posts/create\">\n                    <PostCreateForm token={token} setPosts={setPosts}/>\n                </Route>\n                \n                <Route className=\"item\" path=\"/posts\">\n                    <Posts posts={posts} token={token} setPosts={setPosts}/>\n                </Route>\n                \n                <Route className=\"item\" path=\"/account/:action\">\n                    <Account setToken={setToken}/>\n                </Route>\n\n            </Switch>\n        </div>\n    );\n    \n};\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}