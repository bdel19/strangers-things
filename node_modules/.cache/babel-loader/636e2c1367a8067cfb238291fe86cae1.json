{"ast":null,"code":"const baseURL = 'https://strangers-things.herokuapp.com/api/2207-FTB-ET-WEB-PT/';\nconst makeHeaders = token => {\n  const headers = {\n    \"Content-Type\": \"application/json\"\n  };\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n  return headers;\n};\nconst callAPI = async function (endpointPath) {\n  let defaultOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const options = {\n    headers: makeHeaders(defaultOptions.token)\n  };\n  if (defaultOptions.method) {\n    options.method = defaultOptions.method;\n  }\n  ;\n  if (defaultOptions.body) {\n    options.body = JSON.stringify(defaultOptions.body);\n  }\n  ;\n  try {\n    const response = await fetch(`${baseURL}${endpointPath}`, options);\n    const {\n      success,\n      error,\n      data\n    } = await response.json();\n    if (success) {\n      return {\n        success: success,\n        error: null,\n        data: data\n      };\n    } else {\n      return {\n        success: success,\n        error: error.message,\n        data: null\n      };\n    }\n  } catch {\n    error;\n  }\n  {\n    console.error(`Failed while calling ${endpointPath}:`, error);\n    return {\n      success: false,\n      error: defaultOptions.defaultError,\n      data: null\n    };\n  }\n};\nexport const fetchPosts = async () => {\n  const {\n    success,\n    error,\n    data\n  } = await callAPI('posts', {\n    defaultError: 'failed to load Posts'\n  });\n  return {\n    error: error,\n    posts: success ? data.posts : []\n  };\n};\nexport const registerUser = async (username, password) => {\n  const {\n    success,\n    error,\n    data\n  } = await callAPI('users/register', {\n    method: 'POST',\n    body: {\n      user: {\n        username,\n        password\n      }\n    },\n    defaultError: 'Registration Failed.'\n  });\n  return {\n    error: error,\n    token: success ? data.token : null\n  };\n};\nexport const fetchUser = async token => {\n  const {\n    success,\n    error,\n    data\n  } = await fetch('users/me', {\n    token: token,\n    defaultError: 'Failed to load User information'\n  });\n  return {\n    error: error,\n    user: success ? data.user : null\n  };\n};\nexport const createPost = async (token, description, location) => {\n  const post = {\n    description: description\n  };\n  if (location) {\n    post.location = location;\n  }\n  const {\n    success,\n    error,\n    data\n  } = await callAPI('posts', {\n    token: token,\n    method: 'POST',\n    body: {\n      post: post\n    },\n    defaultError: \"Failed to create Post\"\n  });\n  return {\n    error: error,\n    post: success ? data.post : null\n  };\n};","map":{"version":3,"names":["baseURL","makeHeaders","token","headers","callAPI","endpointPath","defaultOptions","options","method","body","JSON","stringify","response","fetch","success","error","data","json","message","console","defaultError","fetchPosts","posts","registerUser","username","password","user","fetchUser","createPost","description","location","post"],"sources":["/home/bdel19/course_work/strangers-things/src/api/api.js"],"sourcesContent":["const baseURL ='https://strangers-things.herokuapp.com/api/2207-FTB-ET-WEB-PT/';\n\nconst makeHeaders = (token) => {\n    const headers = {\n        \"Content-Type\": \"application/json\",\n    };\n    \n    if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n    }\n\n    return headers;\n};\n\nconst callAPI = async (endpointPath, defaultOptions={}) => {\n    const options = {\n        headers: makeHeaders(defaultOptions.token)\n    };\n\n    if (defaultOptions.method) {\n        options.method = defaultOptions.method;\n    };\n    if (defaultOptions.body){\n        options.body = JSON.stringify(defaultOptions.body);\n    };\n\n    try{\n        const response = await fetch(`${baseURL}${endpointPath}`, options);\n        const {success, error, data} = await response.json();\n\n        if (success) {\n            return {\n                success: success,\n                error: null,\n                data: data\n            };\n        } else {\n            return {\n                success: success,\n                error: error.message,\n                data: null\n            };\n        }\n    } catch {error} {\n        console.error(`Failed while calling ${endpointPath}:`, error);\n\n      return {\n        success: false,\n        error: defaultOptions.defaultError,\n        data: null\n      };\n    }\n};\n\nexport const fetchPosts = async () => {\n    const {success, error, data} = await callAPI('posts', {\n        defaultError: 'failed to load Posts'\n    });\n\n    return {\n        error: error,\n        posts: success ? data.posts : []\n    };\n};\n\nexport const registerUser = async (username, password) => {\n    const {success, error, data} = await callAPI('users/register', {\n        method: 'POST',\n        body: {\n            user: {\n                username,\n                password\n            },\n        },\n        defaultError: 'Registration Failed.'\n    });\n\n    return {\n        error: error,\n        token: success ? data.token : null\n    };\n};\n        \nexport const fetchUser = async(token) => {\n    const {success, error, data} = await fetch('users/me', {\n        token: token,\n        defaultError: 'Failed to load User information'\n    });\n    return {\n        error: error,\n        user: success ? data.user : null\n    };\n};\n\nexport const createPost = async (token, description, location) => {\n    const post = {\n        description: description\n    };\n    if (location) {\n        post.location = location;\n    }\n    const {success, error, data} = await callAPI('posts', {\n        token: token,\n        method: 'POST',\n        body: {\n            post: post\n        },\n        defaultError: \"Failed to create Post\"\n    });\n    return {\n        error: error,\n        post: success ? data.post: null\n    };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}